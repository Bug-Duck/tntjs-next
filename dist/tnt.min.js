var TNT=function(e){"use strict";function t(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function r(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}const n=e=>{const t={};for(const r in e)t[r]="object"!=typeof r?e[r]:n(e[r]);return t},o=(e,t="")=>{try{return Function(`${t}; return ${e};`)()}catch(e){return e.toString()}},i=[],s=new WeakMap,a=(e,t)=>{for(const r in e)"object"==typeof e[r]&&(e[r]=a(e[r],t));const r=new Proxy(e,{get(e,r,n){const o=Reflect.get(e,r,n);return t.onGet(e,r,n),o},set(e,r,n,o){"object"==typeof n&&(n=a(n,t));const i=Reflect.set(e,r,n,o);return t.onSet(e,r,n,o),i},deleteProperty(e,r){const n=Reflect.deleteProperty(e,r);return t.onDeleteProperty(e,r),n}});return Array.isArray(e)&&Object.setPrototypeOf(r,Array.prototype),r},c=(e,t)=>{if(!i.length)return;let r=s.get(e);r||(r=new Map,s.set(e,r));let n=r.get(t);n||(n=new Set,r.set(t,n)),i.forEach((e=>n.add(e)))},l=(e,t)=>{const r=s.get(e);if(!r)return;const n=r.get(t);n&&n.forEach((e=>{e()}))},d=e=>{i.push(e),e(),i.pop()},h=e=>a(e,{onGet(e,t){c(e,t)},onSet(e,t){l(e,t)},onDeleteProperty(){}}),u=e=>{const t={get value(){return c(t,"value"),e},set value(r){r!==e&&(e=r,l(t,"value"))}};return t},f=e=>{const t=u(null);return d((()=>t.value=e())),t},p=["t-if","t-elif"],g=(e,t)=>{let r=!1;return d((()=>{const n=o(e.props.cond,t);r=!!n,e.props.rendered=r.toString()})),r},w=(e,t,r,n)=>{let i=!1;const s=r.children[r.children.length-1];return!(n-1==0||!p.includes(s.tag)||"true"===s.props.rendered)&&(d((()=>{const r=o(e.props.cond,t);i=!!r,e.props.rendered=i.toString()})),i)},m=(e,t,r,n)=>{let i=!1;const s=r.children[r.children.length-1];return!(n-1==0||!p.includes(s.tag))&&(d((()=>{const r=o(s.props.cond,t);i=!r,e.props.rendered=i.toString()})),i)};var v={renderers:[{renderer:(e,t)=>(d((()=>{e.children=o(e.props.data,t).toString()})),!0),name:"variableRenderer",watchTags:["v"]},{renderer:(e,t,r,n)=>{let o=null;return o="t-if"===e.tag?g:"t-elif"===e.tag?w:m,o(e,t,r,n)},name:"conditionRenderer",watchTags:["t-if","t-elif","t-else"]},{renderer:(e,t)=>{const r=e.props.data.split(" in "),i=r[0].trim(),s=o(r[1].trim(),t),a=n(e.el.children[0]);for(const r of s){const n=N(a);C(n,n.el,`const ${i} = ${JSON.stringify(r)}; ${t};`),e.children.push(n)}return!1},name:"loopRenderer",watchTags:["t-for"]}]};const y=(e,t={},r=[],n)=>({tag:e,props:t,children:r,el:n}),b=(e,t)=>{const r=e.el=document.createElement(e.tag);for(const t in e.props){const n=e.props[t];t.startsWith("on")?r.addEventListener(t.slice(2).toLowerCase(),o(n)):r.setAttribute(t,n)}return"string"==typeof e.children?(r.textContent=e.children,void t.appendChild(r)):(e.children.forEach((e=>{b(e,r)})),t.appendChild(r),t)},E=(e,t)=>{if(e.tag===t.tag){const r=t.el=e.el,n=e.props||{},o=t.props||{};for(const e in o){const t=n[e],i=o[e];i!==t&&r.setAttribute(e,i)}for(const e in n)e in o||r.removeAttribute(e);const i=e.children,s=t.children;if("string"==typeof s)return void(r.textContent=s);if("string"==typeof i)return r.innerHTML="",void s.forEach((e=>{b(e,r)}));const a=Math.min(i.length,s.length);for(let e=0;e<a;e++)E(i[e],s[e]);return s.length>i.length?void s.slice(i.length).forEach((e=>{b(e,r)})):s.length<i.length?void i.slice(s.length).forEach((e=>{r.removeChild(e.el)})):void 0}throw new Error("Replacing root elements are not supported.")},T=e=>{const t={};for(let r=0;r<e.attributes.length;r++)t[e.attributes[r].name]=e.attributes[r].value;return t},C=(e,t,r="")=>{let n=!1;[...t.children].forEach(((t,n)=>{let o=!0,i=r;const s=y(t.tagName.toLowerCase(),T(t),[]);s.el=t,v.renderers.forEach((t=>{if(!t.watchTags.includes(s.tag))return;const r=t.renderer(s,i,e,n);if("boolean"!=typeof r){o=r.shouldRender||o;for(const e in r.injectVariables)i+=`const ${e} = ${JSON.stringify(r.injectVariables[e])};`}else o=r?o:r})),o&&C(s,t,i),e.children.push(s),"t-for"===e.tag&&console.log(e)})),e.children.length||t.childNodes.forEach((t=>{n||t.TEXT_NODE&&t.textContent.trim()&&(e.children=t.textContent,n=!0)}))},N=e=>{let t="";return t=e.children.length?e.children[0].nodeType===Node.TEXT_NODE&&e.children[0].textContent.trim()?e.children[0].textContent:[...e.children].filter((e=>e.children.length&&e.children[0].textContent.trim())).map((e=>N(e))):[],y(e.tagName.toLowerCase(),T(e),t,e)};var j,S,O,P;return S=new WeakMap,O=new WeakMap,j=new WeakSet,P=function(e,t){e.children.length>1&&t.remove()},e.TNTApp=class{constructor(){j.add(this),S.set(this,void 0),O.set(this,void 0),r(this,S,(()=>{}),"f"),r(this,O,[],"f"),this.data={},window.data={}}mount(e){let r=!1,o=null,i=null;return t(this,O,"f").push("mount"),d((()=>{var s;const a=null!==(s=null==i?void 0:i.el)&&void 0!==s?s:e.children[0],c=y(a.tagName,T(a),[]);if(c.el=a,C(c,a),i=y(e.tagName,T(a),c.children,a),!r)return o=n(i),b(o,e),r=!0,t(this,j,"m",P).call(this,e,a),void t(this,S,"f").call(this,this);const l=n(i);E(o,l),o=l,t(this,j,"m",P).call(this,e,a)})),this}useData(e){return t(this,O,"f").push("data"),this.data=Object.assign(Object.assign({},this.data),h(e)),window.data=this.data,this}useComputed(e){t(this,O,"f").push("computed"),t(this,O,"f").includes("data")||console.warn("[TNT warn] useComputed() hook is called before useData(). Any reactive data accessed from computed functions will not be accessable.","This may lead to unpredictable results or errors.");for(const t in e)this.data[t]=f(e[t]);return window.data=this.data,this}useEffect(e){return t(this,O,"f").push("effect"),d(e),this}onMounted(e){return r(this,S,e,"f"),this}},e.computed=f,e.getTrackableObject=a,e.h=y,e.mount=b,e.patch=E,e.reactive=h,e.ref=u,e.targetMap=s,e.watchEffect=d,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=tnt.min.js.map
