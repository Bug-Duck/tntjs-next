var TNT=function(e){"use strict";function t(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function r(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}const n=e=>{const t={};for(const r in e)if(Array.isArray(e[r])){const s=[];e[r].forEach((e=>{"object"==typeof e?s.push(n(e)):s.push(e)})),t[r]=s}else"object"!=typeof e[r]||e[r].tagName?t[r]=e[r]:t[r]=n(e[r]);return t},s=(e,t={},r=!0)=>{let n="";for(const e in t)n+=`const ${e} = ${"string"==typeof t[e]?'"'+t[e]+'"':JSON.stringify(t[e])}; `;try{const s=Function("ctx",`with(window.data) {${n}; return ${e};}`);return r?s(t):s}catch(e){return e.toString()}},o=[],i=new WeakMap,a=(e,t)=>{for(const r in e)"object"==typeof e[r]&&(e[r]=a(e[r],t));const r=new Proxy(e,{get(e,r,n){const s=Reflect.get(e,r,n);return t.onGet(e,r,n),s},set(e,r,n,s){"object"==typeof n&&(n=a(n,t));const o=Reflect.set(e,r,n,s);return t.onSet(e,r,n,s),o},deleteProperty(e,r){const n=Reflect.deleteProperty(e,r);return t.onDeleteProperty(e,r),n}});return Array.isArray(e)&&Object.setPrototypeOf(r,Array.prototype),r},c=(e,t)=>{if(!o.length)return;let r=i.get(e);r||(r=new Map,i.set(e,r));let n=r.get(t);n||(n=new Set,r.set(t,n)),o.forEach((e=>n.add(e)))},l=(e,t)=>{const r=i.get(e);if(!r)return;const n=r.get(t);n&&n.forEach((e=>{e()}))},h=e=>{o.push(e),e(),o.pop()},d=e=>a(e,{onGet(e,t){c(e,t)},onSet(e,t){l(e,t)},onDeleteProperty(){}}),u=e=>{const t={get value(){return c(t,"value"),e},set value(r){r!==e&&(e=r,l(t,"value"))}};return t},f=e=>{const t=u(null);return h((()=>t.value=e())),t},p=["t-if","t-elif"],g=["t-if","t-elif","t-else"],w=(e,t)=>{let r=!1;return h((()=>{const n=s(e.props.cond,t);r=!!n,e.props.rendered=r.toString()})),r},v=(e,t,r,n)=>{let o=!1;const i=r.children[r.children.length-1];return!(n-1==0||!p.includes(i.tag)||"true"===i.props.rendered)&&(h((()=>{const r=s(e.props.cond,t);o=!!r,e.props.rendered=o.toString()})),o)},m=(e,t,r,n)=>{let o=!1;const i=r.children[r.children.length-1];return!(n-1==0||!p.includes(i.tag))&&(h((()=>{const r=s(i.props.cond,t);o=!r,e.props.rendered=o.toString()})),o)},y={renderer:(e,t)=>{const r=e.props.data.split(" in "),n=r[0].trim(),o=s(r[1].trim(),t),i=e.el.children[0];e.children=[];for(const[r,s]of o.entries()){const o=W(i);R(o,o.el,Object.assign(Object.assign({},t),{[n]:s}));let a=!0;b.renderers.forEach((i=>{if(!i.shouldFire(o))return;const c=i.renderer(o,Object.assign(Object.assign({},t),{[n]:s}),e,r);a="boolean"!=typeof c?c.shouldRender?a:c.shouldRender:c?a:c})),a&&e.children.push(o)}return!1},name:"loopRenderer",shouldFire:e=>"t-for"===e.tag};var b={renderers:[{renderer:(e,t)=>(h((()=>{e.children=[s(e.props.data,t).toString()]})),!0),name:"variableRenderer",shouldFire:e=>"v"===e.tag},{renderer:(e,t,r,n)=>{let s=null;return s="t-if"===e.tag?w:"t-elif"===e.tag?v:m,s(e,t,r,n)},name:"conditionRenderer",shouldFire:e=>g.includes(e.tag)},y,{renderer:(e,t)=>{const r="/* TNT_RENDERED */",n="__tnt_",o={};for(const i in e.props){let a=i;if(a.startsWith(n)&&(a=a.slice(n.length)),a.startsWith(":")||a.startsWith("on"))if(a.startsWith("on")){if(e.props[i].startsWith(r))continue;const s=n+a;let c="";for(const e in t)c+=`const ${e} = ${JSON.stringify(t[e])}; `;const l=`${r} with (window.data) {${c}${e.props[s in e.props?s:a].toString()}}`;o[s]=e.props[i],e.el.setAttribute(a,l),e.props[a]=l}else i.startsWith(":on")&&console.warn("[TNT warn] Using reactive binding and event listeners at the same time will cause the program to run not as expected.","Please extract logic or remove one of the effect bindings."),e.el.removeAttribute(i),h((()=>{e.el.setAttribute(i.slice(1),s(e.props[i],t))}))}for(const t in o)e.el.setAttribute(t,o[t]),e.props[t]=o[t];return!0},name:"attributeRenderer",shouldFire(e){for(const t in e.props)if(t.startsWith(":")||t.startsWith("on"))return!0;return!1}},{renderer:(e,t)=>{let r;const n=e.props.src,s=e.props.type,o=e.props.data,i=new XMLHttpRequest;if(i.open("GET",n,!1),void 0===o?i.send(null):i.send(o),"text"===s){const t=i.responseText;e.children=[t.toString()]}else if("json"===s){const e=i.responseText;if(!e)return;const t=JSON.parse(e);r=d(t)}return r.requestData={text:i.responseText,code:i.status},{shouldRender:!0,injectVariables:r}},name:"getRenderer",shouldFire:e=>"t-get"===e.tag}]};const T=(e,t={},r,n)=>({tag:e,props:t,children:r,el:n}),E=(e,t,r={})=>{const n=e.el=document.createElement(e.tag);for(const t in e.props){const r=e.props[t];n.setAttribute(t,r)}return b.renderers.forEach((t=>{t.fireOnMounted&&t.shouldFire(e)&&t.renderer(e,r)})),"string"==typeof e.children?(n.textContent=e.children,void t.appendChild(n)):(e.children.forEach((e=>{"string"!=typeof e?E(e,n,r):n.appendChild(document.createTextNode(e))})),t.appendChild(n),t)},N=(e,t,r={})=>{if(e.tag===t.tag){const n=t.el=e.el,s=e.props||{},o=t.props||{};for(const e in o){const t=s[e],r=o[e];r!==t&&n.setAttribute(e,r)}for(const e in s)e in o||n.removeAttribute(e);const i=e.children,a=t.children,c=Math.min(i.length,a.length);for(let e=0;e<c;e++){const t=i[e],s=a[e];"string"!=typeof t||"string"!=typeof s?N(t,s,r):t!==s&&n.replaceChild(document.createTextNode(s),n.childNodes[e])}return a.length>i.length?void a.slice(i.length).forEach((e=>{"string"!=typeof e?E(e,n,r):n.appendChild(document.createTextNode(e))})):a.length<i.length?void i.slice(a.length).forEach(((e,t)=>{"string"!=typeof e?n.removeChild(e.el):n.removeChild(n.childNodes[t])})):void 0}throw new Error("Replacing root elements are not supported.")},M=e=>{const t={};for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r].value;t[e.attributes[r].name]=n}return t},R=(e,t,r={})=>{[...t.childNodes].forEach(((t,n)=>{if(t.nodeType===Node.TEXT_NODE){if(!t.textContent.trim())return;return void e.children.push(t.textContent)}if(t.nodeType!==Node.ELEMENT_NODE)return;let s=!0,o=r;const i=T(t.tagName.toLowerCase(),M(t),[]);i.el=t,b.renderers.forEach((t=>{if(!t.shouldFire(i))return;const r=t.renderer(i,o,e,n);"boolean"!=typeof r?(s=r.shouldRender||s,o=Object.assign(Object.assign({},o),r.injectVariables)):s=r?s:r})),s&&R(i,t,o),e.children.push(i)}))},W=e=>T(e.tagName.toLowerCase(),M(e),[],e);var j,k,S,x;class A{constructor(){j.set(this,void 0),k.set(this,void 0),this.change(window.location.hash.replace(/#/,"")),window.onhashchange=()=>{this.change(window.location.hash.replace(/#/,""))},r(this,j,[],"f")}useRoute(e){t(this,j,"f").push(e),this.change(e.path)}useMainRoute(e){r(this,k,e,"f"),this.change(e)}change(e){if(void 0!==t(this,k,"f"))if(""===e)try{t(this,j,"f").forEach((e=>{if(e.path===t(this,k,"f"))throw e.ele.style.visibility="visible",new Error("break");e.ele.style.visibility="hidden"}))}catch(e){if("break"!==e)throw e}else t(this,j,"f").forEach((t=>{t.path!==e?(t.ele.style.visibility="hidden",window.location.hash=e.toString()):t.ele.style.visibility="visible"}))}}j=new WeakMap,k=new WeakMap;S=new WeakMap,x=new WeakMap;const C=new A;var O,P,$,D,F,_,L,G,J,q,V;return P=new WeakMap,$=new WeakMap,D=new WeakMap,F=new WeakMap,_=new WeakMap,L=new WeakMap,G=new WeakMap,J=new WeakMap,O=new WeakSet,q=function(){const e=(e,r,n)=>{Array.isArray(n)&&(e.reactive[r].splice(0,e.reactive[r].length),e.reactive[r].push(...n)),l(t(this,_,"f")[r],r)},r={get(e,t){if("symbol"!=typeof t)return(t=t.toString())in e.reactive?e.reactive[t]:t in e.computed?e.computed[t].value:t in e.ref?(c(e.ref[t],"value"),e.ref[t].value):void console.warn(`[TNT warn] You accessed a value not defined (Reading '${t}').`)},set:(t,r,n)=>r in t.reactive?(e(t,r,n),!0):r in t.ref?(t.ref[r].value=n,l(t.ref[r],"value"),!0):(console.warn(`[TNT warn] You set a value not defined (Reading '${r}').`),!1),has:(e,t)=>("symbol"==typeof t&&(t=t.toString()),!(t in globalThis)&&(t in e.ref||t in e.reactive||t in e.computed))};return new Proxy({reactive:t(this,P,"f"),computed:t(this,$,"f"),ref:t(this,D,"f")},r)},V=function(e,t){e.children.length>1&&t.remove()},e.Route=A,e.Router=C,e.TNTApp=class{constructor(){O.add(this),P.set(this,void 0),$.set(this,void 0),D.set(this,void 0),F.set(this,void 0),_.set(this,void 0),L.set(this,void 0),G.set(this,void 0),J.set(this,void 0),r(this,L,(()=>{}),"f"),r(this,G,[],"f"),r(this,$,{},"f"),r(this,P,{},"f"),r(this,D,{},"f"),r(this,J,[],"f"),r(this,_,{},"f"),window.data={}}mount(e){let r=!1,s=null,o=null;return t(this,G,"f").push("mount"),h((()=>{var i;const a=null!==(i=null==o?void 0:o.el)&&void 0!==i?i:e.children[0],c=T(a.tagName,M(a),[]);if(c.el=a,R(c,a,{}),o=T(e.tagName,M(a),c.children,a),!r)return s=n(o),E(s,e,{}),r=!0,t(this,O,"m",V).call(this,e,a),void t(this,L,"f").call(this,this);const l=n(o);N(s,l,{}),s=n(l),t(this,O,"m",V).call(this,e,a)})),this}get data(){return t(this,F,"f")}useData(e){t(this,G,"f").push("data"),r(this,_,n(e),"f"),r(this,P,{},"f"),r(this,D,{},"f");for(const r in e)"object"!=typeof e[r]?t(this,D,"f")[r]=u(e[r]):t(this,P,"f")[r]=d(e[r]);return r(this,F,t(this,O,"m",q).call(this),"f"),window.data=t(this,F,"f"),this}useComputed(e){t(this,G,"f").push("computed"),t(this,G,"f").includes("data")||console.warn("[TNT warn] useComputed() hook is called before useData(). Any reactive data accessed from computed functions will not be accessable.","This may lead to unpredictable results or errors.");for(const r in e)t(this,$,"f")[r]=f(e[r]);return r(this,F,t(this,O,"m",q).call(this),"f"),window.data=t(this,F,"f"),this}useEffect(e){return t(this,G,"f").push("effect"),t(this,J,"f").push(e),h(e),this}onMounted(e){return r(this,L,e,"f"),this}},e.computed=f,e.getTrackableObject=a,e.h=T,e.mount=E,e.patch=N,e.r=class{constructor(e,t){S.set(this,void 0),x.set(this,void 0),r(this,x,t,"f"),r(this,S,e,"f")}get path(){return t(this,S,"f")}get ele(){return t(this,x,"f")}},e.reactive=d,e.ref=u,e.targetMap=i,e.track=c,e.trigger=l,e.watchEffect=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=tnt.min.js.map
