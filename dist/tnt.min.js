var TNT=function(e){"use strict";function t(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function r(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}const n=e=>{const t={};for(const r in e)if(Array.isArray(e[r])){const o=[];e[r].forEach((e=>{"object"==typeof e?o.push(n(e)):o.push(e)})),t[r]=o}else"object"!=typeof e[r]||e[r].tagName?t[r]=e[r]:t[r]=n(e[r]);return t},o=(e,t={},r=!0)=>{let n="";for(const e in t)n+=`const ${e} = ${"string"==typeof t[e]?'"'+t[e]+'"':JSON.stringify(t[e])}; `;try{const o=Function("ctx",`with(window.data) {${n}; return ${e};}`);return r?o(t):o}catch(e){return e.toString()}},s=[],i=new WeakMap,a=(e,t)=>{for(const r in e)"object"==typeof e[r]&&(e[r]=a(e[r],t));const r=new Proxy(e,{get(e,r,n){const o=Reflect.get(e,r,n);return t.onGet(e,r,n),o},set(e,r,n,o){"object"==typeof n&&(n=a(n,t));const s=Reflect.set(e,r,n,o);return t.onSet(e,r,n,o),s},deleteProperty(e,r){const n=Reflect.deleteProperty(e,r);return t.onDeleteProperty(e,r),n}});return Array.isArray(e)&&Object.setPrototypeOf(r,Array.prototype),r},c=(e,t)=>{if(!s.length)return;let r=i.get(e);r||(r=new Map,i.set(e,r));let n=r.get(t);n||(n=new Set,r.set(t,n)),s.forEach((e=>n.add(e)))},l=(e,t)=>{const r=i.get(e);if(!r)return;const n=r.get(t);n&&n.forEach((e=>{e()}))},h=e=>{s.push(e),e(),s.pop()},d=e=>a(e,{onGet(e,t){c(e,t)},onSet(e,t){l(e,t)},onDeleteProperty(){}}),u=e=>{const t={get value(){return c(t,"value"),e},set value(r){r!==e&&(e=r,l(t,"value"))}};return t},f=e=>{const t=u(null);return h((()=>t.value=e())),t},p=["t-if","t-elif"],g=["t-if","t-elif","t-else"],w=(e,t)=>{let r=!1;return h((()=>{const n=o(e.props.cond,t);r=!!n,e.props.rendered=r.toString()})),r},v=(e,t,r,n)=>{let s=!1;const i=r.children[r.children.length-1];return!(n-1==0||!p.includes(i.tag)||"true"===i.props.rendered)&&(h((()=>{const r=o(e.props.cond,t);s=!!r,e.props.rendered=s.toString()})),s)},m=(e,t,r,n)=>{let s=!1;const i=r.children[r.children.length-1];return!(n-1==0||!p.includes(i.tag))&&(h((()=>{const r=o(i.props.cond,t);s=!r,e.props.rendered=s.toString()})),s)},y={renderer:(e,t)=>{const r=e.props.data.split(" in "),n=r[0].trim(),s=o(r[1].trim(),t),i=e.el.children[0];e.children=[];for(const[r,o]of s.entries()){const s=M(i);k(s,s.el,Object.assign(Object.assign({},t),{[n]:o}));let a=!0;b.renderers.forEach((i=>{if(!i.shouldFire(s))return;const c=i.renderer(s,Object.assign(Object.assign({},t),{[n]:o}),e,r);a="boolean"!=typeof c?c.shouldRender?a:c.shouldRender:c?a:c})),a&&e.children.push(s)}return!1},name:"loopRenderer",shouldFire:e=>"t-for"===e.tag};var b={renderers:[{renderer:(e,t)=>(h((()=>{e.children=[o(e.props.data,t).toString()]})),!0),name:"variableRenderer",shouldFire:e=>"v"===e.tag},{renderer:(e,t,r,n)=>{let o=null;return o="t-if"===e.tag?w:"t-elif"===e.tag?v:m,o(e,t,r,n)},name:"conditionRenderer",shouldFire:e=>g.includes(e.tag)},y,{renderer:(e,t)=>{const r="/* TNT_RENDERED */",n="__tnt_",s={};for(const i in e.props){let a=i;if(a.startsWith(n)&&(a=a.slice(n.length)),a.startsWith(":")||a.startsWith("on"))if(a.startsWith("on")){if(e.props[i].startsWith(r))continue;const o=n+a;let c="";for(const e in t)c+=`const ${e} = ${JSON.stringify(t[e])}; `;const l=`${r} with (window.data) {${c}${e.props[o in e.props?o:a].toString()}}`;s[o]=e.props[i],e.el.setAttribute(a,l),e.props[a]=l}else i.startsWith(":on")&&console.warn("[TNT warn] Using reactive binding and event listeners at the same time will cause the program to run not as expected.","Please extract logic or remove one of the effect bindings."),e.el.removeAttribute(i),h((()=>{e.el.setAttribute(i.slice(1),o(e.props[i],t))}))}for(const t in s)e.el.setAttribute(t,s[t]),e.props[t]=s[t];return!0},name:"attributeRenderer",shouldFire(e){for(const t in e.props)if(t.startsWith(":")||t.startsWith("on"))return!0;return!1}},{renderer:(e,t)=>{let r;const n=e.props.src,o=e.props.type,s=e.props.data,i=new XMLHttpRequest;if(i.open("GET",n,!1),void 0===s?i.send(null):i.send(s),"text"===o){const t=i.responseText;e.children=[t.toString()]}else if("json"===o){const e=i.responseText;if(!e)return;const t=JSON.parse(e);r=d(t)}return r.requestData={text:i.responseText,code:i.status},{shouldRender:!0,injectVariables:r}},name:"getRenderer",shouldFire:e=>"t-get"===e.tag}]};const T=(e,t={},r,n)=>({tag:e,props:t,children:r,el:n}),E=(e,t,r={})=>{const n=e.el=document.createElement(e.tag);for(const t in e.props){const r=e.props[t];n.setAttribute(t,r)}return b.renderers.forEach((t=>{t.fireOnMounted&&t.shouldFire(e)&&t.renderer(e,r)})),"string"==typeof e.children?(n.textContent=e.children,void t.appendChild(n)):(e.children.forEach((e=>{"string"!=typeof e?E(e,n,r):n.appendChild(document.createTextNode(e))})),t.appendChild(n),t)},N=(e,t,r={})=>{if(e.tag===t.tag){const n=t.el=e.el,o=e.props||{},s=t.props||{};for(const e in s){const t=o[e],r=s[e];r!==t&&n.setAttribute(e,r)}for(const e in o)e in s||n.removeAttribute(e);const i=e.children,a=t.children,c=Math.min(i.length,a.length);for(let e=0;e<c;e++){const t=i[e],o=a[e];"string"!=typeof t||"string"!=typeof o?N(t,o,r):t!==o&&n.replaceChild(document.createTextNode(o),n.childNodes[e])}return a.length>i.length?void a.slice(i.length).forEach((e=>{"string"!=typeof e?E(e,n,r):n.appendChild(document.createTextNode(e))})):a.length<i.length?void i.slice(a.length).forEach(((e,t)=>{"string"!=typeof e?n.removeChild(e.el):n.removeChild(n.childNodes[t])})):void 0}throw new Error("Replacing root elements are not supported.")},W=e=>{const t={};for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r].value;t[e.attributes[r].name]=n}return t},k=(e,t,r={})=>{[...t.childNodes].forEach(((t,n)=>{if(t.nodeType===Node.TEXT_NODE){if(!t.textContent.trim())return;return void e.children.push(t.textContent)}if(t.nodeType!==Node.ELEMENT_NODE)return;let o=!0,s=r;const i=T(t.tagName.toLowerCase(),W(t),[]);i.el=t,b.renderers.forEach((t=>{if(!t.shouldFire(i))return;const r=t.renderer(i,s,e,n);"boolean"!=typeof r?(o=r.shouldRender||o,s=Object.assign(Object.assign({},s),r.injectVariables)):o=r?o:r})),o&&k(i,t,s),e.children.push(i)}))},M=e=>T(e.tagName.toLowerCase(),W(e),[],e);var R,S,j,C,x,A;class O{constructor(){R.add(this),S.set(this,void 0),j.set(this,void 0),console.log("%c route init finish!","color: red"),t(this,R,"m",C).call(this,window.location.hash.replace(/#/,"")),window.onhashchange=()=>{console.log("%c hash change!","color: red"),t(this,R,"m",C).call(this,window.location.hash.replace(/#/,""))},r(this,S,[],"f")}useRoute(e){t(this,S,"f").push(e),t(this,R,"m",C).call(this,e.path),console.log("%c Use route finish!","color: red")}useMainRoute(e){r(this,j,e,"f"),console.log("%c Set mainly route!","color: red")}toggle(e){t(this,R,"m",C).call(this,window.location.hash.replace(/#/,"")),window.history.pushState({},document.title,`#${e.toString()}`),console.log("%c hash change!","color: red")}}S=new WeakMap,j=new WeakMap,R=new WeakSet,C=function(e){if(void 0===t(this,j,"f"))return console.log("%c Change route finish!","color: red");if(""===e)try{t(this,S,"f").forEach((e=>{if(e.path===t(this,j,"f"))throw e.ele.style.display="block",new Error("break");e.ele.style.display="none"}))}catch(e){if("break"!==e)throw e}else t(this,S,"f").forEach((t=>{t.path!==e?(t.ele.style.display="block",window.location.hash=e.toString()):t.ele.style.display="none"}));console.log("%c Change route finish!","color: red")};x=new WeakMap,A=new WeakMap;const P=new O;var $,D,F,_,L,G,J,q,U,V,X;return D=new WeakMap,F=new WeakMap,_=new WeakMap,L=new WeakMap,G=new WeakMap,J=new WeakMap,q=new WeakMap,U=new WeakMap,$=new WeakSet,V=function(){const e=(e,r,n)=>{Array.isArray(n)&&(e.reactive[r].splice(0,e.reactive[r].length),e.reactive[r].push(...n)),l(t(this,G,"f")[r],r)},r={get(e,t){if("symbol"!=typeof t)return(t=t.toString())in e.reactive?e.reactive[t]:t in e.computed?e.computed[t].value:t in e.ref?(c(e.ref[t],"value"),e.ref[t].value):void console.warn(`[TNT warn] You accessed a value not defined (Reading '${t}').`)},set:(t,r,n)=>r in t.reactive?(e(t,r,n),!0):r in t.ref?(t.ref[r].value=n,l(t.ref[r],"value"),!0):(console.warn(`[TNT warn] You set a value not defined (Reading '${r}').`),!1),has:(e,t)=>("symbol"==typeof t&&(t=t.toString()),!(t in globalThis)&&(t in e.ref||t in e.reactive||t in e.computed))};return new Proxy({reactive:t(this,D,"f"),computed:t(this,F,"f"),ref:t(this,_,"f")},r)},X=function(e,t){e.children.length>1&&t.remove()},e.Route=O,e.Router=P,e.TNTApp=class{constructor(){$.add(this),D.set(this,void 0),F.set(this,void 0),_.set(this,void 0),L.set(this,void 0),G.set(this,void 0),J.set(this,void 0),q.set(this,void 0),U.set(this,void 0),r(this,J,(()=>{}),"f"),r(this,q,[],"f"),r(this,F,{},"f"),r(this,D,{},"f"),r(this,_,{},"f"),r(this,U,[],"f"),r(this,G,{},"f"),window.data={}}mount(e){let r=!1,o=null,s=null;return t(this,q,"f").push("mount"),h((()=>{var i;const a=null!==(i=null==s?void 0:s.el)&&void 0!==i?i:e.children[0],c=T(a.tagName,W(a),[]);if(c.el=a,k(c,a,{}),s=T(e.tagName,W(a),c.children,a),!r)return o=n(s),E(o,e,{}),r=!0,t(this,$,"m",X).call(this,e,a),void t(this,J,"f").call(this,this);const l=n(s);N(o,l,{}),o=n(l),t(this,$,"m",X).call(this,e,a)})),this}get data(){return t(this,L,"f")}useData(e){t(this,q,"f").push("data"),r(this,G,n(e),"f"),r(this,D,{},"f"),r(this,_,{},"f");for(const r in e)"object"!=typeof e[r]?t(this,_,"f")[r]=u(e[r]):t(this,D,"f")[r]=d(e[r]);return r(this,L,t(this,$,"m",V).call(this),"f"),window.data=t(this,L,"f"),this}useComputed(e){t(this,q,"f").push("computed"),t(this,q,"f").includes("data")||console.warn("[TNT warn] useComputed() hook is called before useData(). Any reactive data accessed from computed functions will not be accessable.","This may lead to unpredictable results or errors.");for(const r in e)t(this,F,"f")[r]=f(e[r]);return r(this,L,t(this,$,"m",V).call(this),"f"),window.data=t(this,L,"f"),this}useEffect(e){return t(this,q,"f").push("effect"),t(this,U,"f").push(e),h(e),this}onMounted(e){return r(this,J,e,"f"),this}},e.computed=f,e.getTrackableObject=a,e.h=T,e.mount=E,e.patch=N,e.r=class{constructor(e,t){x.set(this,void 0),A.set(this,void 0),r(this,A,t,"f"),r(this,x,e,"f")}get path(){return t(this,x,"f")}get ele(){return t(this,A,"f")}},e.reactive=d,e.ref=u,e.targetMap=i,e.track=c,e.trigger=l,e.watchEffect=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=tnt.min.js.map
